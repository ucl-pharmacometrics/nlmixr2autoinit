% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_single_point_extra.R
\name{run_single_point_extra}
\alias{run_single_point_extra}
\title{Perform extended single-point pharmacokinetic calculations}
\usage{
run_single_point_extra(
  dat = NULL,
  half_life = NULL,
  single_point_base.lst = NULL,
  route = c("bolus", "oral", "infusion"),
  dose_type = NULL,
  pooled_ctrl = pooled_control(),
  ssctrl = ss_control()
)
}
\arguments{
\item{dat}{A data frame of pharmacokinetic observations.}

\item{half_life}{Numeric. half-life (in the same time units as
the data). Used to derive missing \eqn{CL} or \eqn{V_d} when needed and to
restrict oral \eqn{k_a} calculations to the absorption phase.}

\item{single_point_base.lst}{A list object returned by \code{single_point_base}, containing preprocessed data and initial calculations for \eqn{CL} and \eqn{V_d}.}

\item{route}{Character. Administration route; one of \code{"bolus"},
\code{"oral"}, or \code{"infusion"}. Determines which single-point rules and
fallbacks are applied.}

\item{dose_type}{Optional character string indicating the dosing scenario for
alignment with pooled processing, e.g., \code{"first_dose"},
\code{"repeated_doses"}, or \code{"combined_doses"}.}

\item{pooled_ctrl}{A list of pooled-analysis control options created by
\code{\link{pooled_control}}. Controls time binning and TAD rounding used if
additional pooled summaries are needed.}

\item{ssctrl}{A list of steady-state control options created by
\code{\link{ss_control}}. Governs assumptions and thresholds used when
interpreting or approximating steady-state behavior in single-point logic.}
}
\value{
A list containing:
\itemize{
\item \code{singlepoint.results}: A data frame with estimated \eqn{k_a}, \eqn{CL}, \eqn{V_d}, and processing time.
\item \code{dat}: The input dataset used in the calculations.
\item \code{single_point_ka_df}: Data used for \eqn{k_a} calculations (if applicable).
\item \code{single_point_cl_df}: Data used for \eqn{CL} calculations.
\item \code{single_point_vd_df}: Data used for \eqn{V_d} calculations.
\item \code{single_point_vd_cmax_df}: \eqn{C_{\mathrm{max}}} data used for \eqn{V_d} estimation.
}
}
\description{
Extends the single-point pharmacokinetic calculations by incorporating additional logic to derive clearance (\eqn{CL}), volume of distribution (\eqn{V_d}), and absorption rate constant (\eqn{k_a}) based on the availability of data. The function evaluates which parameters were not successfully calculated in the \code{single_point_base} step and uses appropriate methods to estimate missing parameters.
}
\details{
The function uses a series of conditional logic to determine which pharmacokinetic parameters have not been calculated in the \code{single_point_base} part and derives them using the parameters that have already been calculated:
\itemize{
\item \strong{Successfully Calculated \eqn{CL} and \eqn{V_d}:}
\itemize{
\item If both \eqn{CL} and \eqn{V_d} are successfully calculated in the \code{single_point_base} part, they are directly used in the results without further derivations.
}
\item \strong{Uncalculated \eqn{V_d}:}
\itemize{
\item If \eqn{V_d} cannot be calculated in the \code{single_point_base} part but \eqn{CL} and \eqn{t_{1/2}} are available, \eqn{V_d} is derived using:
\deqn{V_d = \frac{CL \cdot t_{1/2}}{\ln(2)}}
}
\item \strong{Uncalculated \eqn{CL}:}
\itemize{
\item If \eqn{CL} cannot be calculated in the \code{single_point_base} part but \eqn{V_d} and \eqn{t_{1/2}} are available, \eqn{CL} is derived using:
\deqn{CL = \frac{V_d \cdot \ln(2)}{t_{1/2}}}
}
\item \strong{Uncalculated Both \eqn{CL} and \eqn{V_d}:}
\itemize{
\item If neither \eqn{CL} nor \eqn{V_d} can be calculated in the \code{single_point_base} part, \eqn{V_d} is estimated from \eqn{C_{\mathrm{max}}} and dose:
\deqn{V_d = \frac{\mathrm{Dose}}{C_{\mathrm{max}}}}
\eqn{CL} is then derived from \eqn{V_d} and \eqn{t_{1/2}}.
}
\item \strong{Oral Absorption Rate (\eqn{k_a}):}
\itemize{
\item For oral dosing, the calculation focuses on data collected before \eqn{t_{\mathrm{max}}}, ensuring that \eqn{\mathrm{tad} < 0.2 \cdot \mathrm{half-life}} to reflect the absorption phase.
\item The absorption rate constant (\eqn{k_a}) is computed using the \code{run_ka_solution} function, which applies a solution-based approach tailored to the selected data points.
}
}
}
\examples{

# Example usage with preprocessed theo_md data
dat <- Bolus_1CPT
out <- processData(dat)
fdat<- out$dat
froute <-out$Datainfo$Value[out$Datainfo$Infometrics == "Dose Route"]
half_life <- get_hf(dat = fdat)$half_life_median
run_single_point_extra( route=froute,half_life=half_life, single_point_base.lst=run_single_point_base(dat = fdat, half_life = half_life,route=froute))

}
