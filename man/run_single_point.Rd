% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_single_point (copy).R,
%   R/run_single_point_extra.R
\name{run_single_point}
\alias{run_single_point}
\title{Run single-point pharmacokinetic analysis}
\usage{
run_single_point(
  dat,
  route = c("bolus", "oral", "infusion"),
  half_life = NULL,
  dose_type = NULL,
  pooled_ctrl = pooled_control(),
  ssctrl = ss_control()
)

run_single_point(
  dat,
  route = c("bolus", "oral", "infusion"),
  half_life = NULL,
  dose_type = NULL,
  pooled_ctrl = pooled_control(),
  ssctrl = ss_control()
)
}
\arguments{
\item{dat}{A pharmacokinetic dataset.}

\item{route}{Character string: one of \code{"bolus"}, \code{"infusion"}, \code{"oral"}.}

\item{half_life}{Optional numeric value for the elimination half-life. Estimated if NULL.}

\item{dose_type}{Optional character string (e.g. \code{"bolus"} or \code{"infusion"}). Required if \code{half_life} is NULL.}

\item{pooled_ctrl}{Control list from \code{\link{pooled_control}()}.}

\item{ssctrl}{Control list from \code{\link{ss_control}()}.}
}
\value{
A list containing:
\itemize{
\item \code{singlepoint.results}: A data frame with estimated \eqn{CL}, \eqn{V_d}, \eqn{k_a}, processing time, and a descriptive message.
\item \code{dat}: The input dataset used in the calculations.
\item \code{single_point_ka_df}: Data used for \eqn{k_a} calculations (if applicable).
\item \code{single_point_cl_df}: Data used for \eqn{CL} calculations.
\item \code{single_point_vd_df}: Data used for \eqn{V_d} calculations.
\item \code{approx.vc.out}: A message or result indicating whether the approximate central volume of distribution (\eqn{V_d}) was successfully estimated.
}

An object of class \code{"single.point.lst"} containing all results from base and extended estimation.
}
\description{
This function performs a single-point pharmacokinetic analysis, estimating key parameters such as clearance (\eqn{CL}), volume of distribution (\eqn{V_d}), and absorption rate constant (\eqn{k_a}) based on the provided dataset and optional half-life (\eqn{t_{1/2}}).

This function runs both base and extended single-point pharmacokinetic calculations
to estimate clearance (CL), volume of distribution (Vd), and absorption rate constant (Ka) when possible.
}
\details{
This function integrates two key components:
\itemize{
\item \code{single_point_base}: Conducts basic single-point calculations to estimate parameters based on steady-state or dose-interval data.
\item \code{single_point_extra}: Extends the analysis to handle additional cases, such as calculating oral absorption rate (\eqn{k_a}) or estimating parameters when data is incomplete (e.g., when \eqn{CL} or \eqn{V_d} is missing).
}
}
\examples{
# Example 1 (iv case)
dat <- Bolus_1CPT
fdat <- processData(dat)$dat
half_life<-half_life_estimated(dat = fdat)$half_life_median
run_single_point(fdat,half_life)

# Example 2 (infusion case).

dat <- Infusion_1CPT
fdat <- processData(dat)$dat
half_life<-half_life_estimated(dat = fdat)$half_life_median
run_single_point(fdat,half_life)

dat <- Oral_1CPT
fdat <- processData(dat)$dat
half_life<-half_life_estimated(dat = fdat)$half_life_median
run_single_point(fdat,half_life)

\dontrun{
# Example: Adaptive single-point PK analysis for bolus data
dat <- Bolus_1CPT
# Step 1: Preprocess the data
out <- processData(dat)
fdat <- out$dat
# Step 2: Extract route and dose type info
froute <- out$Datainfo$Value[out$Datainfo$Infometrics == "Dose Route"]
fdose_type <- out$Datainfo$Value[out$Datainfo$Infometrics == "Dose Type"]
# Step 3: Estimate half life
half_life <- get_hf(dat = fdat)$half_life_median
# Step 3: Run single-point analysis (CL, Vd, Ka if oral)
result <- run_single_point(
  dat = fdat,
 route = froute,
 dose_type = fdose_type,
  half_life = half_life
)
# Step 4: View results
print(result$singlepoint.results)
head(result$single_point_cl_df)  # Data used for CL estimation
head(result$single_point_vd_df)  # Data used for Vd estimation
#' head(result$single_point_ka_df)  # Ka (only if oral)
}


}
