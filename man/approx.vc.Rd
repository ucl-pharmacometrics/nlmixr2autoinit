% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_single_point.R
\name{approx.vc}
\alias{approx.vc}
\title{Approximate volume of distribution based on Cmax}
\usage{
approx.vc(dat, half_life, single_point_base.lst)
}
\arguments{
\item{dat}{A data frame containing pharmacokinetic data, including observed concentrations (\(DV\)), time after dose (\(tad\)), dose, and route information.}

\item{half_life}{The half-life of the drug, used to filter \(C_{\text{max}}\) points to the early phase of elimination.}

\item{route}{The route of administration, either \code{"bolus"} (default) or \code{"infusion"}. Determines the formula for \(V_d\) calculation.}
}
\value{
The trimmed geometric mean of the approximated \(V_d\), calculated across individuals.
}
\description{
Approximates the volume of distribution (\(V_d\)) using observed \(C_{\text{max}}\) values.
The calculation assumes rapid absorption (\(k_a \gg k_e\)), meaning that \(C_{\text{max}}\) occurs shortly after dosing, before significant elimination has taken place.
To ensure this assumption, \(C_{\text{max}}\) points are filtered to those occurring within \(0.2 \times \text{half-life}\), a time window where elimination is minimal.
}
\details{
\itemize{
\item \strong{Rapid Absorption Assumption:}
When \eqn{k_a \gg k_e}, most of the absorption is completed before elimination significantly impacts the drug concentration. Under this assumption, \eqn{C_{\mathrm{max}}} is dominated by absorption rather than elimination.
\item \strong{Why \eqn{0.2 \cdot \mathrm{half-life}}:}
\itemize{
\item At \eqn{0.2 \cdot \mathrm{half-life}}, less than 13\% of the drug is eliminated. This is derived from the intravenous (IV) exponential decay model:
\deqn{\mathrm{Elimination\ Fraction} = 1 - e^{-k_e \cdot t}}
Substituting \eqn{t = 0.2 \cdot \mathrm{half-life}} and \eqn{k_e = \ln(2) / \mathrm{half-life}}:
\deqn{\mathrm{Elimination\ Fraction} = 1 - e^{-\ln(2) \cdot 0.2} \approx 0.13}
This ensures the selected \eqn{C_{\mathrm{max}}} points primarily reflect absorption dynamics.
}
\item \strong{Data Filtering:}
\itemize{
\item Observed data (\code{EVID == 0}) is grouped by \code{ID} and \code{dose_number}.
\item The \eqn{C_{\mathrm{max}}} for each group is identified and further filtered to include only points where \eqn{tad < 0.2 \cdot \mathrm{half-life}}.
}
\item \strong{Volume of Distribution Calculation (single-dose):}
\itemize{
\item For bolus administration:
\deqn{V_d = \frac{\mathrm{Dose}}{C_{\mathrm{max}}}}
\item For infusion:
\deqn{V_d = \frac{\mathrm{Rate} \cdot \min(\mathrm{Time}, \mathrm{Duration})}{C_{\mathrm{max}}}}
}
\item \strong{Summary of \eqn{V_d} values:}
\itemize{
\item Individual \eqn{V_d} values are summarized using a trimmed geometric mean (\eqn{10\%}) to reduce the impact of outliers.
}
\item \strong{Accumulation Ratio (\eqn{R_{\mathrm{ac}}}):}
\itemize{
\item For multiple-dose scenarios, the accumulation ratio is calculated as:
\deqn{R_{\mathrm{ac}} = \frac{1}{1 - e^{-k_e \cdot \tau}}}
where:
\itemize{
\item \eqn{k_e = \frac{\ln(2)}{\mathrm{half-life}}} is the elimination rate constant.
\item \eqn{\tau} is the dosing interval (\code{dose_interval}).
}
\item The accumulation ratio represents the steady-state concentration relative to the single-dose concentration.
}
\item \strong{Volume of Distribution Calculation (multiple-dose):}
\itemize{
\item For infusion routes:
\deqn{V_d = \frac{\mathrm{Rate} \cdot \min(\mathrm{Time}, \mathrm{Duration})}{C_{\mathrm{max}} / R_{\mathrm{ac}}}}
\itemize{
\item \eqn{\mathrm{Rate}} is the infusion rate.
\item \eqn{\min(\mathrm{Time}, \mathrm{Duration})} represents the shorter of infusion time or observation time.
\item \eqn{C_{\mathrm{max}} / R_{\mathrm{ac}}} adjusts the observed concentration to reflect single-dose dynamics.
}
\item For bolus or other routes:
\deqn{V_d = \frac{\mathrm{Dose}}{C_{\mathrm{max}} / R_{\mathrm{ac}}}}
\itemize{
\item \eqn{\mathrm{Dose}} is the administered dose.
}
}
}
}
\examples{
# Example 1: Bolus administration
dat<-Bolus_2CPT
dat<-processData(dat)$dat
approx.vc(dat,half_life = half_life_estimated(dat)$half_life_median)

# Example 2: Oral administration
dat<-Oral_2CPT
dat<-processData(dat)$dat
approx.vc(dat,half_life = half_life_estimated(dat)$half_life_median)

# Example 3: Theno_sd
dat<-theo_sd
dat<-processData(dat)$dat
approx.vc(dat,half_life = half_life_estimated(dat)$half_life_median)

# Example 3: Theno_md
dat<-theo_md
dat<-processData(dat)$dat
approx.vc(dat,half_life = half_life_estimated(dat)$half_life_median)


}
