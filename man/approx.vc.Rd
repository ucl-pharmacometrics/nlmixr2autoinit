% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_single_point.R
\name{approx.vc}
\alias{approx.vc}
\title{Approximate volume of distribution based on Cmax}
\usage{
approx.vc(dat, half_life, single_point_base.lst)
}
\arguments{
\item{dat}{A data frame containing pharmacokinetic data, including observed concentrations (\(DV\)), time after dose (\(tad\)), dose, and route information.}

\item{half_life}{The half-life of the drug, used to filter \(C_{\text{max}}\) points to the early phase of elimination.}

\item{route}{The route of administration, either \code{"bolus"} (default) or \code{"infusion"}. Determines the formula for \(V_d\) calculation.}
}
\value{
The trimmed geometric mean of the approximated \(V_d\), calculated across individuals.
}
\description{
Approximates the volume of distribution (\(V_d\)) using observed \(C_{\text{max}}\) values.
The calculation assumes rapid absorption (\(k_a \gg k_e\)), meaning that \(C_{\text{max}}\) occurs shortly after dosing, before significant elimination has taken place.
To ensure this assumption, \(C_{\text{max}}\) points are filtered to those occurring within \(0.2 \times \text{half-life}\), a time window where elimination is minimal.
}
\details{
The method relies on the following logic:
\itemize{
\item \strong{Rapid Absorption Assumption:} When \(k_a \gg k_e\), most of the absorption is completed before elimination significantly impacts drug concentration. Under this assumption, \(C_{\text{max}}\) is dominated by absorption, not elimination.
\item \strong{Why \(0.2 \times \text{half-life}\):}
\itemize{
\item At \(0.2 \times \text{half-life}\), less than 13\% of the drug has been eliminated. This is derived from the exponential decay model:
[
\text{Elimination Fraction} = 1 - e^{-k_e \cdot t}
]
Substituting \(t = 0.2 \cdot \text{half-life}\) and \(k_e = \ln(2) / \text{half-life}\):
[
\text{Elimination Fraction} = 1 - e^{-\ln(2) \cdot 0.2} \approx 0.13
]
This ensures the selected \(C_{\text{max}}\) points reflect absorption dynamics rather than elimination.
}
\item \strong{Data Filtering:}
\itemize{
\item Observed data (\(EVID == 0\)) is grouped by \(ID\) and \(dose\_number\).
\item The \(C_{\text{max}}\) for each group is identified and further filtered to include only points where \(tad < 0.2 \times \text{half-life}\).
}
\item \strong{Volume of Distribution Calculation:}
\itemize{
\item For bolus: \(V_d = \frac{\text{Dose}}{C_{\text{max}}}\).
\item For infusion: \(V_d = \frac{\text{Rate} \cdot \min(\text{Time}, \text{Duration})}{C_{\text{max}}}\).
}
\item Individual \(V_d\) values are summarised using a trimmed geometric mean (\(10\\%\)) to reduce the impact of outliers.
}
}
\examples{
# Example 1: Bolus administration
dat<-Bolus_2CPT
dat<-processData(dat)$dat
approx.vc(dat,half_life = half_life_estimated(dat)$half_life_median)

# Example 2: Oral administration
dat<-Oral_2CPT
dat<-processData(dat)$dat
approx.vc(dat,half_life = half_life_estimated(dat)$half_life_median)

# Example 3: Theno_sd
dat<-theo_sd
dat<-processData(dat)$dat
approx.vc(dat,half_life = half_life_estimated(dat)$half_life_median)

# Example 3: Theno_md
dat<-theo_md
dat<-processData(dat)$dat
approx.vc.lst<-approx.vc(dat,half_life = half_life_estimated(dat)$half_life_median)
approx.vc.lst

}
