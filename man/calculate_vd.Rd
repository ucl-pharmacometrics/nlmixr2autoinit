% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_single_point_base.R
\name{calculate_vd}
\alias{calculate_vd}
\title{Estimate volume of distribution from concentration data}
\usage{
calculate_vd(
  dat,
  half_life = NULL,
  dose_type = NULL,
  pooled_ctrl = pooled_control(),
  route = c("bolus", "oral", "infusion")
)
}
\arguments{
\item{dat}{A data frame containing raw timeâ€“concentration data in the
standard nlmixr2 format.}

\item{half_life}{Optional numeric value for the drug's half-life.
If not provided, it will be estimated using \code{get_hf()} from pooled
observations.}

\item{dose_type}{Specifies the dosing context of the pharmacokinetic
observations. Required when half_life is not provided. Classified as
first_dose, repeated_doses, or combined_doses based on whether observed
concentrations occur following the first administration, during repeated
dosing, or across both contexts.}

\item{pooled_ctrl}{Optional list of control parameters used by \code{get_pooled_data()}
for pooling observations. Defaults to output from \code{pooled_control()}.}

\item{route}{Character string specifying the route of administration. Must be
one of bolus, oral, or infusion. Currently, oral is not implemented.}
}
\value{
A list with two elements:
\itemize{
\item vd_df: individual volume of distribution estimates
\item trimmed_mean_vd: population volume of distribution estimated as a
trimmed geometric mean using a 5 percent trimming level
}
}
\description{
Calculates the apparent volume of distribution (Vd) for intravenous
bolus or infusion routes using an adaptive single-point method. If the
half-life is not provided, it is estimated from pooled data.
}
\details{
The function uses an early concentration point (based on time since dosing and half-life)
to estimate Vd. For bolus:
\deqn{Vd = \frac{\text{Dose}}{C_0}}
For infusion:
\deqn{Vd = \frac{\text{Rate} \times \min(\text{TIME}, \text{durationobs})}{C}}
where \code{C} is the observed concentration (\code{DV}).

When half_life is not provided, it is estimated from pooled data using
the functions get_pooled_data() and get_hf().
}
\examples{

dat <- Bolus_1CPT
out <- processData(dat)
fdat<- out$dat
froute <-out$Datainfo$Value[out$Datainfo$Infometrics == "Dose Route"]
half_life <- get_hf(dat = fdat)$half_life_median
calculate_vd(dat = fdat, half_life = half_life,route=froute)$trimmed_mean_vd

}
\seealso{
\link{get_pooled_data}, \link{get_hf}, \link{trimmed_geom_mean}
}
