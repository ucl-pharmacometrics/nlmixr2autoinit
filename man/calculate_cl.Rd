% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_single_point_base.R
\name{calculate_cl}
\alias{calculate_cl}
\title{Calculate Clearance (CL) using adaptive single-point method}
\usage{
calculate_cl(
  dat,
  half_life = NULL,
  dose_type = NULL,
  pooled_ctrl = pooled_control(),
  ssctrl = ss_control()
)
}
\arguments{
\item{dat}{A data frame containing pharmacokinetic data. Required columns typically include \code{ID}, \code{TIME}, \code{DV}, \code{tad}, \code{recent_ii}, \code{dose}, \code{routeobs}, and \code{durationobs}.}

\item{half_life}{(Optional) Numeric value for the drug's half-life. If not provided, it will be estimated using \code{get_hf()} from pooled observations.}

\item{dose_type}{(Optional) Character string indicating the route of administration (e.g., \code{"bolus"}, \code{"infusion"}, \code{"oral"}). Required if \code{half_life} is not provided.}

\item{pooled_ctrl}{A list of control settings generated by \code{\link{pooled_control}()} to define pooling rules for half-life estimation.}

\item{ssctrl}{A list of control parameters generated by \code{\link{ss_control}()} to guide the detection of steady-state observations.}
}
\value{
A list with the following elements:
\describe{
\item{dat}{The full processed dataset, with flags for steady-state and calculated CL values.}
\item{cl_df}{A subset of \code{dat} containing observations used in the clearance estimation.}
\item{trimmed_mean_cl}{The trimmed geometric mean of clearance values across individuals.}
}
}
\description{
Calculates drug clearance (CL) from steady-state pharmacokinetic data using an adaptive single-point approach.
}
\details{
This function performs clearance calculations using data collected at steady state. If the half-life is unknown, it is estimated from pooled data using control logic.

The method identifies steady-state observations, selects peak/trough/average concentrations based on dose timing and concentration decay characteristics, and calculates individual and population-level clearance:
\itemize{
\item Estimates half-life (if not provided) using pooled intervals.
\item Detects steady-state observations using \code{ss_control()} rules.
\item Selects minimum and maximum concentration values per interval to classify concentration type (\code{Css_type}).
\item Calculates individual clearance as: \eqn{CL = \frac{Dose}{Css \times \tau}}.
\item Computes a trimmed geometric mean of individual clearance values to reduce outlier influence.
}

Supports bolus, short-term infusion, and oral administration.
}
\examples{
\dontrun{
# Bolus example
dat <- Bolus_1CPT
fdat <- processData(dat)$dat
half_life <- get_hf(dat = fdat)$half_life_median
calculate_cl(dat = fdat, half_life = half_life)

# Infusion example
dat <- Infusion_1CPT
fdat <- processData(dat)$dat
half_life <- get_hf(dat = fdat)$half_life_median
calculate_cl(dat = fdat, half_life = half_life)

# Oral case without pre-specified half-life
dat <- Oral_1CPT
fdat <- processData(dat)$dat
calculate_cl(dat = fdat, half_life = 11)
}

}
\seealso{
\code{\link{pooled_control}},
\code{\link{ss_control}},
\code{\link{trimmed_geom_mean}}
}
