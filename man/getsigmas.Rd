% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getsigma.R
\name{getsigmas}
\alias{getsigmas}
\title{Estimate individual-level residual error from elimination phase}
\usage{
getsigmas(group_df, nlastpoints = 3)
}
\arguments{
\item{group_df}{A data frame for a single group (e.g., one subject/dose),
containing columns \code{EVID}, \code{DV}, \code{TIME}, and \code{routeobs}.}

\item{nlastpoints}{Integer. Number of terminal points to include in regression.}
}
\value{
A tibble with columns:
\describe{
\item{intercept}{Intercept of the regression line}
\item{slope}{Slope of the regression line}
\item{residual_sd_additive}{Standard deviation of additive residuals}
\item{residual_sd_proportional}{Standard deviation of proportional residuals}
}
}
\description{
Performs log-linear regression on the elimination phase of a
single individual's (or one groupâ€™s) pharmacokinetic data to estimate additive
and proportional residual standard deviations.
}
\details{
The elimination phase is selected differently based on the \code{routeobs} value:
\itemize{
\item For \code{bolus} and \code{infusion}, it starts \emph{after} Tmax.
\item For \code{oral}, it starts \emph{at} Tmax.
}

The function uses the last \code{nlastpoints} data points in the elimination phase.
Residuals are calculated as:
\itemize{
\item Additive: \eqn{IPRED - DV}
\item Proportional: \eqn{DV / IPRED - 1}
}

Returns NA values if the data is insufficient or inconsistent.
}
\examples{
\dontrun{
dat<- Bolus_1CPT
dat<-processData(dat)$dat
getsigmas(dat[dat$ID==1 & dat$dose_number==1 & dat$resetflag==1&dat$EVID==0,])
}


}
