% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/force_find_lambdaz.R
\name{force_find_lambdaz}
\alias{force_find_lambdaz}
\title{Forceful estimation of terminal slope (Lambda_z)}
\usage{
force_find_lambdaz(time, conc, ...)
}
\arguments{
\item{time}{Numeric vector of time points.}

\item{conc}{Numeric vector of concentration measurements corresponding to \code{time}.}

\item{...}{Additional arguments passed to \code{find_best_lambdaz}, such as \code{nlastpoints}.}
}
\value{
A list containing:
\describe{
\item{\code{lambdaz}}{Estimated terminal elimination rate constant (lambda_z, 1/time units)}
\item{\code{intercept}}{Intercept of the log-linear regression, used to extrapolate C0}
\item{\code{method}}{Method used: \code{\"find_best_lambdaz\"} or \code{\"fallback_regression\"}}
\item{\code{UsedPoints}}{Time-concentration points used for terminal slope estimation}
\item{\code{adj.r.squared}}{Adjusted R-squared (only available when using find_best_lambdaz, otherwise NA)}
\item{\code{message}}{Text message indicating fit diagnostics}
\item{\code{slopefit}}{The fitted lm() object from regression}
}
}
\description{
Estimates the terminal slope (lambda_z) of a pharmacokinetic profile
by first attempting to use the \code{find_best_lambdaz} method. If no valid lambda_z
is identified, it falls back to simplified linear regression (log concentration vs time)
using a decreasing number of points to forcibly find an acceptable estimate.
}
\details{
This function implements a two-step strategy to ensure estimation of the terminal elimination slope:
\enumerate{
\item First, it applies \code{find_best_lambdaz} to automatically select the best fitting terminal phase segment
based on adjusted R-squared optimization.
\item If \code{find_best_lambdaz} fails (e.g., poor data quality or lack of clear terminal phase), the function
forcibly fits simplified linear models using progressively fewer points (starting from \code{n-1} down to 2)
until a negative slope is identified. In fallback mode, adjusted R-squared is not considered.
}

Application scenarios include:
\itemize{
\item Exploratory pharmacokinetic (PK) data analysis
\item Analysis of datasets with limited or poor quality data
\item Automated processing pipelines where manual curve fitting is impractical
\item Cases where half-life estimation is required for reporting or modeling purposes
}
}
\examples{
# Basic usage

time <- c(0.5, 1, 2, 4, 6, 8, 10)
conc <- c(12, 8, 5, 3, 2, 1.5, 1)
find_best_lambdaz(time, conc)

time <- c(0.5, 1, 2)
conc <- c(12, 8, 5)
force_find_lambdaz(time, conc)


}
\seealso{
\code{\link{find_best_lambdaz}}
}
