% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bin.time.R
\name{bin.time}
\alias{bin.time}
\title{Bin PK time-concentration data using quantile or algorithmic binning}
\usage{
bin.time(
  dat,
  nbins = "auto",
  bin.method = c("quantile", "jenks", "kmeans", "pretty", "sd", "equal", "density")
)
}
\arguments{
\item{dat}{A data frame containing PK data. Must include:
\itemize{
\item \code{tad}: time after dose
\item \code{DVstd}: standardized concentration (e.g., DV/dose)
\item \code{EVID}: (optional) event ID; rows with \code{EVID == 0} will be used
}}

\item{nbins}{Number of bins or \code{"auto"}:
\itemize{
\item For \code{method = "quantile"}: \code{"auto"} defaults to 10 (deciles)
\item For other methods: \code{"auto"} uses Sturges' rule: \code{ceiling(log2(n)) + 1}
}}

\item{bin.method}{Binning strategy (default = \code{"quantile"}). Options:
\itemize{
\item \code{"quantile"}: Equal-frequency binning by empirical quantiles
\item \code{"jenks"}: Natural breaks (minimizes intra-bin variance)
\item \code{"kmeans"}, \code{"pretty"}, \code{"sd"}, \code{"equal"}, \code{"density"}: other methods from \code{classInt}
}}
}
\value{
A list containing:
\describe{
\item{binned.df}{Data frame of median time and concentration per bin}
\item{bin_limits.df}{Data frame with upper time boundary for each bin}
\item{breaks}{Breakpoints used to define time bins}
\item{method_used}{Binning method used}
\item{nbins_final}{Final number of bins (length of breaks - 1)}
}
}
\description{
Bins pharmacokinetic (PK) data by time, using either equal-frequency (quantile)
binning or algorithmic methods supported by the \code{vpc} package, such as Jenks
natural breaks or k-means clustering.
}
\details{
This function supports both quantile-based binning (used in NCA) and
adaptive binning strategies (used in VPC), with optional automatic
bin count determination.
}
\examples{

dat <- Bolus_1CPT
dat <- nmpkconvert(dat)
dat <- calculate_tad(dat)
dat$DVstd <- dat$DV / dat$dose
bin.time(dat)

}
