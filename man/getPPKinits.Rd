% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getPPKinits.R
\name{getPPKinits}
\alias{getPPKinits}
\title{Automated Pipeline for Initial Estimates in Population Pharmacokinetic Modeling}
\usage{
getPPKinits(dat, control = initsControl())
}
\arguments{
\item{dat}{A \code{data.frame} containing pharmacokinetic observations, including dosing events
(EVID = 1) and concentration-time data (EVID = 0). Required columns include \code{ID}, \code{TIME}, \code{EVID}, and \code{DV}.}

\item{control}{A list generated by \code{initsControl()} that specifies the configuration for the parameter estimation pipeline. The list contains the following sub-components:
\itemize{
\item \code{pooled.control}: Settings for handling pooled pharmacokinetic data (see \code{pooled_control()}).
\item \code{nca.control}: Configuration options for non-compartmental analysis (NCA) procedures (see \code{nca_control()}).
\item \code{ss.control}: Controls for steady-state or single-sample estimation methods (see \code{ss_control()}).
\item \code{fallback.control}: Rules for applying fallback mechanisms when primary estimation methods fail or return invalid values, including options for fixed \code{ka} values and sigma fallback strategies (see \code{fallback_control()}).
\item \code{selmetrics}: A character vector specifying model selection metrics used to evaluate parameter performance. Valid choices include "APE", "MAE", "MAPE", "RMSE", "rRMSE1", and "rRMSE2".
}}
}
\value{
An environment of class \code{getPPKinits}, containing:
\itemize{
\item \code{Datainfo}: Summary information about the dataset
\item \code{Recommended_initial_estimates}: A data.frame listing parameter names, selection methods, and estimated values
\item \code{Run.history}: All intermediate estimation results, including outputs from:
- Single-point estimation
- Residual graphical analysis
- Pooled NCA
- Wanger–Nelson estimation
- Parameter sweeping for one-, two-, and three-compartment models
\item \code{Parameter.descriptions}: A character vector explaining the meaning of each estimated parameter
}
}
\description{
This function provides a comprehensive and automated framework to generate initial parameter estimates
for population pharmacokinetic (PK) models. It implements a non-iterative, model-informed strategy,
incorporating naive pooled non-compartmental analysis (NCA), graphical residual-based estimation,
adaptive single-point heuristics, and parameter sweeping for nonlinear and multi-compartmental models.
The framework is designed to support a wide range of intravenous (IV) and oral PK data scenarios.
}
\details{
The methodology is described in detail by Huang et al. (2024) and is tailored for high-throughput
estimation in both sparse and richly sampled datasets, helping improve robustness and convergence in
subsequent nonlinear mixed-effects modeling.

This pipeline executes the following sequence:
\enumerate{
\item Data preprocessing and route/type detection
\item Analytical estimation via:
\itemize{
\item Single-point heuristics (CL, Vd, Ka)
\item Residual binning methods (CL, Vd, Ka)
\item Pooled NCA with optional Wanger–Nelson Ka estimation
}
\item Performance metrics (APE, MAE, MAPE, RMSE, rRMSE) from simulated concentration profiles using \code{rxSolve}
\item Selection of optimal base parameter set based on a configurable criterion
\item Parameter sweeping for:
\itemize{
\item Michaelis–Menten kinetics (Vmax, Km)
\item Two- and three-compartmental PK models (Vc, Vp, Q, Q2, etc.)
}
\item Final recommendation of starting values for CL, Vd, Ka, Vmax, Km, and inter-compartmental parameters
}

The estimation methods are non-fitting (analytical) and do not require optimization, making this tool suitable for
initializing nonlinear mixed-effects models in software such as NONMEM, Monolix, or nlmixr2.
}
\examples{
\dontrun{
dat<-Bolus_1CPT
initsout <- getPPKinits(dat)

dat<-Infusion_1CPT
initsout <- getPPKinits(dat)

dat<-Oral_1CPT
initsout <- getPPKinits(dat)
}
}
\references{
Huang, Z., Fidler, M., Lan, M., Cheng, L.L., Kloprogge, F. et al. (2024).
An automated pipeline to generate initial estimates for population pharmacokinetic models.
Preprint. https://doi.org/10.21203/rs.3.rs-5806446/v1
}
\seealso{
\code{\link{initsControl}}, \code{\link{rxSolve}}, \code{\link{nlmixr2}}, \code{\link{nca_control}}
}
